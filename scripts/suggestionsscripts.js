(function(a){a.fn.suggestionsAddress=function(b,c){if(!b){return}a(this).suggestions({serviceUrl:"https://dadata.ru/api/v2",token:b,type:"ADDRESS",triggerSelectOnSpace:false,triggerSelectOnBlur:false,onSelect:function(d){a(c).val(d.data.postal_code)}})}})(jQuery);
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(a){var e={ENTER:13,ESC:27,TAB:9,SPACE:32,UP:38,DOWN:40},k={},d=".suggestions",b="suggestions",m="\\s\"'~\\*\\.,:\\|\\[\\]\\(\\)\\{\\}<>№",p=new RegExp("["+m+"]+","g"),n="\\-\\+\\/\\\\\\?!@#$%^&",o=new RegExp("["+n+"]+","g"),c={autoSelectFirst:false,serviceUrl:null,onSearchStart:a.noop,onSearchComplete:a.noop,onSearchError:a.noop,onSuggestionsFetch:null,onSelect:null,onSelectNothing:null,onInvalidateSelection:null,minChars:1,deferRequestBy:100,params:{},paramName:"query",timeout:3000,formatResult:null,formatSelected:null,noCache:false,containerClass:"suggestions-suggestions",tabDisabled:false,triggerSelectOnSpace:false,triggerSelectOnEnter:true,triggerSelectOnBlur:true,preventBadQueries:false,hint:"Выберите вариант или продолжите ввод",type:null,requestMode:"suggest",count:5,$helpers:null,headers:null,scrollOnFocus:true,mobileWidth:980,initializeInterval:100};var g={chains:{},on:function(r,q){this.get(r).push(q);return this},get:function(r){var q=this.chains;return q[r]||(q[r]=[])}};var l=(function(){var r=0;return{escapeRegExChars:function(s){return s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},escapeHtml:function(t){var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};if(t){a.each(s,function(u,v){t=t.replace(new RegExp(u,"g"),v)})}return t},getDefaultType:function(){return(a.support.cors?"POST":"GET")},getDefaultContentType:function(){return(a.support.cors?"application/json":"application/x-www-form-urlencoded")},fixURLProtocol:function(s){return a.support.cors?s:s.replace(/^https?:/,location.protocol)},addUrlParams:function(t,s){return t+(/\?/.test(t)?"&":"?")+a.param(s)},serialize:function(s){if(a.support.cors){return JSON.stringify(s,function(t,u){return u===null?undefined:u})}else{return a.param(s,true)}},compact:function(s){return a.grep(s,function(t){return !!t})},delay:function(t,s){return setTimeout(t,s||0)},uniqueId:function(s){return(s||"")+ ++r},slice:function(s,t){return Array.prototype.slice.call(s,t)},areSame:function q(s,t){var u=true;if(typeof s!=typeof t){return false}if(typeof s=="object"&&s!=null&&t!=null){a.each(s,function(v,w){return u=q(w,t[v])});return u}return s===t},arrayMinus:function(s,t){return t?a.grep(s,function(u,v){return a.inArray(u,t)===-1}):s},arrayMinusWithPartialMatching:function(s,t){return t?a.grep(s,function(u,v){return !t.some(function(w){return w.indexOf(u)===0})}):s},getWords:function(v,u){v=v.replace(/(\d+)([а-яА-ЯёЁ]{2,})/g,"$1 $2").replace(/([а-яА-ЯёЁ]+)(\d+)/g,"$1 $2");var w=this.compact(v.split(p)),t=w.pop(),s=this.arrayMinus(w,u);s.push(t);return s},normalize:function(t,s){var u=this;return u.getWords(t,s).join(" ")},stringEncloses:function(s,t){return s.length>t.length&&s.indexOf(t)!==-1},fieldsNotEmpty:function(t,s){if(!a.isPlainObject(t)){return false}var u=true;a.each(s,function(w,v){return u=!!(t[v])});return u},getDeepValue:function q(t,s){var u=s.split("."),v=u.shift();return t&&(u.length?q(t[v],u.join(".")):t[v])},reWordExtractor:function(){return new RegExp("([^"+m+"]*)(["+m+"]*)","g")},formatToken:function(s){return s&&s.toLowerCase().replace(/[ёЁ]/g,"е")},withSubTokens:function(t){var s=[];a.each(t,function(u,w){var v=w.split(o);s.push(w);if(v.length>1){s=s.concat(l.compact(v))}});return s}}}());var f=function(){function s(t){return function(w){if(w.length===0){return false}if(w.length===1){return true}var v=t(w[0].value),u=a.grep(w,function(x){return t(x.value).indexOf(v)===0},true);return u.length===0}}var q=s(function(t){return t});var r=s(function(t){return t.replace(/, (?:д|вл|двлд|к) .+$/,"")});return{matchByNormalizedQuery:function(v,y){var w=v.toLowerCase(),x=this&&this.stopwords,u=l.normalize(w,x),t=[];a.each(y,function(z,B){var A=B.value.toLowerCase();if(l.stringEncloses(w,A)){return false}if(A.indexOf(u)>0){return false}if(u===l.normalize(A,x)){t.push(z)}});return t.length===1?t[0]:-1},matchByWords:function(u,y){var x=this&&this.stopwords,v=u.toLowerCase(),w,t=[];if(q(y)){w=l.withSubTokens(l.getWords(v,x));a.each(y,function(z,B){var A=B.value.toLowerCase();if(l.stringEncloses(v,A)){return false}var C=l.withSubTokens(l.getWords(A,x));if(l.arrayMinus(w,C).length===0){t.push(z)}})}return t.length===1?t[0]:-1},matchByWordsAddress:function(u,y){var x=this&&this.stopwords,v=u.toLowerCase(),w,t=-1;if(r(y)){w=l.withSubTokens(l.getWords(v,x));a.each(y,function(z,B){var A=B.value.toLowerCase();if(l.stringEncloses(v,A)){return false}var C=l.withSubTokens(l.getWords(A,x));if(l.arrayMinus(w,C).length===0){t=z;return false}})}return t},matchByFields:function(u,w){var v=this&&this.stopwords,t=this&&this.fieldsStopwords,y=l.withSubTokens(l.getWords(u.toLowerCase(),v)),x=[];if(w.length===1){if(t){a.each(t,function(z,C){var A=l.getDeepValue(w[0],z),B=A&&l.withSubTokens(l.getWords(A.toLowerCase(),C));if(B&&B.length){x=x.concat(B)}})}if(l.arrayMinusWithPartialMatching(y,x).length===0){return 0}}return -1}}}();(function(){var q=["ао","аобл","дом","респ","а/я","аал","автодорога","аллея","арбан","аул","б-р","берег","бугор","вал","вл","волость","въезд","высел","г","городок","гск","д","двлд","днп","дор","дп","ж/д_будка","ж/д_казарм","ж/д_оп","ж/д_платф","ж/д_пост","ж/д_рзд","ж/д_ст","жилзона","жилрайон","жт","заезд","заимка","зона","к","казарма","канал","кв","кв-л","км","кольцо","комн","кордон","коса","кп","край","линия","лпх","м","массив","местность","мкр","мост","н/п","наб","нп","обл","округ","остров","оф","п","п/о","п/р","п/ст","парк","пгт","пер","переезд","пл","пл-ка","платф","погост","полустанок","починок","пр-кт","проезд","промзона","просек","просека","проселок","проток","протока","проулок","р-н","рзд","россия","рп","ряды","с","с/а","с/мо","с/о","с/п","с/с","сад","сквер","сл","снт","спуск","ст","ст-ца","стр","тер","тракт","туп","у","ул","уч-к","ф/х","ферма","х","ш","бульвар","владение","выселки","гаражно-строительный","город","деревня","домовладение","дорога","квартал","километр","комната","корпус","литер","леспромхоз","местечко","микрорайон","набережная","область","переулок","платформа","площадка","площадь","поселение","поселок","проспект","разъезд","район","республика","село","сельсовет","слобода","сооружение","станица","станция","строение","территория","тупик","улица","улус","участок","хутор","шоссе"];var u=/<strong>/;var t={LEGAL:[2,2,5,1],INDIVIDUAL:[2,2,6,2]};function v(y,w){var x=y.data&&y.data[w];return x&&new RegExp("^"+l.escapeRegExChars(x)+"(["+m+"]|$)","i").test(y.value)}function r(x,w){return u.test(w)&&!u.test(x)?w:x}function s(A,w,x,C,B){var D=this,z=D.highlightMatches(A,x,C,B),y=D.highlightMatches(w,x,C,B);return r(z,y)}k.NAME={urlSuffix:"fio",matchers:[f.matchByNormalizedQuery,f.matchByWords],fieldNames:{surname:"фамилия",name:"имя",patronymic:"отчество"},alwaysContinueSelecting:true,isDataComplete:function(z){var A=this,y=A.options.params,w=z.data,x;if(a.isFunction(y)){y=y.call(A.element,z.value)}if(y&&y.parts){x=a.map(y.parts,function(B){return B.toLowerCase()})}else{x=["surname","name"];if(v(z,"surname")){x.push("patronymic")}}return l.fieldsNotEmpty(w,x)},composeValue:function(w){return l.compact([w.surname,w.name,w.patronymic]).join(" ")}};k.ADDRESS={urlSuffix:"address",matchers:[a.proxy(f.matchByNormalizedQuery,{stopwords:q}),a.proxy(f.matchByWordsAddress,{stopwords:q})],boundsAvailable:["region","area","city","settlement","street","house"],boundsFields:{region:["region","region_type","region_type_full","region_with_type"],area:["area","area_type","area_type_full","area_with_type"],city:["city","city_type","city_type_full","city_with_type"],settlement:["settlement","settlement_type","settlement_type_full","settlement_with_type"],street:["street","street_type","street_type_full","street_with_type"],house:["house","house_type","house_type_full","block","block_type"]},unformattableTokens:q,enrichmentEnabled:true,geoEnabled:true,isDataComplete:function(y){var x=[this.bounds.to||"flat"],w=y.data;return !a.isPlainObject(w)||l.fieldsNotEmpty(w,x)},composeValue:function(w){return l.compact([w.region_with_type||l.compact([w.region,w.region_type]).join(" "),w.area_with_type||l.compact([w.area_type,w.area]).join(" "),w.city_with_type||l.compact([w.city_type,w.city]).join(" "),w.settlement_with_type||l.compact([w.settlement_type,w.settlement]).join(" "),w.street_with_type||l.compact([w.street_type,w.street]).join(" "),l.compact([w.house_type,w.house,w.block_type,w.block]).join(" "),l.compact([w.flat_type,w.flat]).join(" "),w.postal_box?"а/я "+w.postal_box:null]).join(", ")}};k.PARTY={urlSuffix:"party",matchers:[a.proxy(f.matchByFields,{fieldsStopwords:{value:null,"data.address.value":q,"data.inn":null,"data.ogrn":null}})],geoEnabled:true,formatResult:function(F,x,D,C){var E=this,z=E.type.formatResultInn.call(E,D,x),B=E.highlightMatches(l.getDeepValue(D.data,"ogrn"),x,D),A=r(z,B),y=E.highlightMatches(l.getDeepValue(D.data,"management.name"),x,D),w=l.getDeepValue(D.data,"address.value")||"";if(E.isMobile){(C||(C={})).maxLength=50}F=s.call(E,F,l.getDeepValue(D.data,"name.latin"),x,D,C);F=E.wrapFormattedValue(F,D);if(w){w=w.replace(/^(\d{6}?\s+|Россия,\s+)/i,"");if(E.isMobile){w=w.replace(new RegExp("^([^"+m+"]+["+m+"]+[^"+m+"]+).*"),"$1")}else{w=E.highlightMatches(w,x,D,{unformattableTokens:q})}}if(A||w||y){F+='<div class="'+E.classes.subtext+'"><span class="'+E.classes.subtext_inline+'">'+(A||"")+"</span>"+(r(w,y)||"")+"</div>"}return F},formatResultInn:function(C,w){var D=this,y=C.data&&C.data.inn,A=t[C.data&&C.data.type],z,x,B=/\d/;if(y){x=D.highlightMatches(y,w,C);if(A){x=x.split("");z=a.map(A,function(G){var F="",E;while(G&&(E=x.shift())){F+=E;if(B.test(E)){G--}}return F});x=z.join('<span class="'+D.classes.subtext_delimiter+'"></span>')+x.join("")}return x}}};k.EMAIL={urlSuffix:"email",matchers:[f.matchByNormalizedQuery],isQueryRequestable:function(w){return this.options.suggest_local||w.indexOf("@")>=0}};k.BANK={urlSuffix:"bank",matchers:[a.proxy(f.matchByFields,{fieldsStopwords:{value:null,"data.bic":null}})],formatResult:function(C,x,A,z){var B=this,y=B.highlightMatches(l.getDeepValue(A.data,"bic"),x,A),w=l.getDeepValue(A.data,"address.value")||"";C=B.highlightMatches(C,x,A,z);C=B.wrapFormattedValue(C,A);if(w){w=w.replace(/^\d{6}( РОССИЯ)?, /i,"");if(B.isMobile){w=w.replace(new RegExp("^([^"+m+"]+["+m+"]+[^"+m+"]+).*"),"$1")}else{w=B.highlightMatches(w,x,A,{unformattableTokens:q})}}if(y||w){C+='<div class="'+B.classes.subtext+'"><span class="'+B.classes.subtext_inline+'">'+y+"</span>"+w+"</div>"}return C},formatSelected:function(w){return l.getDeepValue(w,"data.name.payment")}};a.extend(c,{suggest_local:true})}());var i={suggest:{defaultParams:{type:l.getDefaultType(),dataType:"json",contentType:l.getDefaultContentType()},addTypeInUrl:true},detectAddressByIp:{defaultParams:{type:"GET",dataType:"json"},addTypeInUrl:false},status:{defaultParams:{type:"GET",dataType:"json"},addTypeInUrl:true},findById:{defaultParams:{type:l.getDefaultType(),dataType:"json",contentType:l.getDefaultContentType()},addTypeInUrl:true}};var h={suggest:{method:"suggest",userSelect:true,updateValue:true,enrichmentEnabled:true},findById:{method:"findById",userSelect:false,updateValue:false,enrichmentEnabled:false}};function j(q,r){var s=this;s.element=q;s.el=a(q);s.suggestions=[];s.badQueries=[];s.selectedIndex=-1;s.currentValue=s.element.value;s.intervalId=0;s.cachedResponse={};s.enrichmentCache={};s.currentRequest=null;s.inputPhase=a.Deferred();s.fetchPhase=a.Deferred();s.enrichPhase=a.Deferred();s.onChangeTimeout=null;s.triggering={};s.$wrapper=null;s.options=a.extend({},c,r);s.classes={hint:"suggestions-hint",mobile:"suggestions-mobile",nowrap:"suggestions-nowrap",selected:"suggestions-selected",suggestion:"suggestions-suggestion",subtext:"suggestions-subtext",subtext_inline:"suggestions-subtext suggestions-subtext_inline",subtext_delimiter:"suggestions-subtext-delimiter",subtext_label:"suggestions-subtext suggestions-subtext_label",removeConstraint:"suggestions-remove",value:"suggestions-value"};s.disabled=false;s.selection=null;s.$viewport=a(window);s.$body=a(document.body);s.type=null;s.status={};s.setupElement();s.initializer=a.Deferred();if(s.el.is(":visible")){s.initializer.resolve()}else{s.deferInitialization()}s.initializer.done(a.proxy(s.initialize,s))}j.utils=l;j.defaultOptions=c;j.version="16.6.1";a.Suggestions=j;j.prototype={initialize:function(){var q=this;q.uniqueId=l.uniqueId("i");q.createWrapper();q.notify("initialize");q.bindWindowEvents();q.setOptions();q.fixPosition()},deferInitialization:function(){var s=this,r="mouseover focus keydown",t,q=function(){s.initializer.resolve();s.enable()};s.initializer.always(function(){s.el.off(r,q);clearInterval(t)});s.disabled=true;s.el.on(r,q);t=setInterval(function(){if(s.el.is(":visible")){q()}},s.options.initializeInterval)},isInitialized:function(){return this.initializer.state()==="resolved"},dispose:function(){var q=this;q.initializer.reject();q.notify("dispose");q.el.removeData(b).removeClass("suggestions-input");q.unbindWindowEvents();q.removeWrapper();q.el.trigger("suggestions-dispose")},notify:function(r){var s=this,q=l.slice(arguments,1);return a.map(g.get(r),function(t){return t.apply(s,q)})},createWrapper:function(){var q=this;q.$wrapper=a('<div class="suggestions-wrapper"/>');q.el.after(q.$wrapper);q.$wrapper.on("mousedown"+d,a.proxy(q.onMousedown,q))},removeWrapper:function(){var q=this;if(q.$wrapper){q.$wrapper.remove()}a(q.options.$helpers).off(d)},onMousedown:function(q){var r=this;q.preventDefault();r.cancelBlur=true;l.delay(function(){delete r.cancelBlur});if(a(q.target).closest(".ui-menu-item").length==0){l.delay(function(){a(document).one("mousedown",function(t){var s=r.el.add(r.$wrapper).add(r.options.$helpers);if(r.options.floating){s=s.add(r.$container)}s=s.filter(function(){return this===t.target||a.contains(this,t.target)});if(!s.length){r.hide()}})})}},bindWindowEvents:function(){var r=this,q=a.proxy(r.fixPosition,r);r.$viewport.on("resize"+d+r.uniqueId,q).on("scroll"+d+r.uniqueId,q)},unbindWindowEvents:function(){this.$viewport.off("resize"+d+this.uniqueId).off("scroll"+d+this.uniqueId)},scrollToTop:function(){var r=this,q=r.options.scrollOnFocus;if(q===true){q=r.el}if(q instanceof a&&q.length>0){a("body,html").animate({scrollTop:q.offset().top},"fast")}},setOptions:function(q){var r=this;a.extend(r.options,q);a.each({type:k,requestMode:h},function(t,s){r[t]=s[r.options[t]];if(!r[t]){r.disable();throw"`"+t+"` option is incorrect! Must be one of: "+a.map(s,function(v,u){return'"'+u+'"'}).join(", ")}});a(r.options.$helpers).off(d).on("mousedown"+d,a.proxy(r.onMousedown,r));if(r.isInitialized()){r.notify("setOptions")}},fixPosition:function(q){var t=this,r={},u,s;t.isMobile=t.$viewport.width()<=t.options.mobileWidth;if(!t.isInitialized()||(q&&q.type=="scroll"&&!(t.options.floating||t.isMobile))){return}t.$container.appendTo(t.options.floating?t.$body:t.$wrapper);t.notify("resetPosition");t.el.css("paddingLeft","");t.el.css("paddingRight","");r.paddingLeft=parseFloat(t.el.css("paddingLeft"));r.paddingRight=parseFloat(t.el.css("paddingRight"));a.extend(r,t.el.offset());r.borderTop=t.el.css("border-top-style")=="none"?0:parseFloat(t.el.css("border-top-width"));r.borderLeft=t.el.css("border-left-style")=="none"?0:parseFloat(t.el.css("border-left-width"));r.innerHeight=t.el.innerHeight();r.innerWidth=t.el.innerWidth();r.outerHeight=t.el.outerHeight();r.componentsLeft=0;r.componentsRight=0;u=t.$wrapper.offset();s={top:r.top-u.top,left:r.left-u.left};t.notify("fixPosition",s,r);if(r.componentsLeft>r.paddingLeft){t.el.css("paddingLeft",r.componentsLeft+"px")}if(r.componentsRight>r.paddingRight){t.el.css("paddingRight",r.componentsRight+"px")}},clearCache:function(){this.cachedResponse={};this.enrichmentCache={};this.badQueries=[]},clear:function(){var q=this;if(q.isInitialized()){q.clearCache();q.currentValue="";q.selection=null;q.hide();q.suggestions=[];q.el.val("");q.el.trigger("suggestions-clear");q.notify("clear")}},disable:function(){var q=this;q.disabled=true;q.abortRequest();if(q.visible){q.hide()}},enable:function(){this.disabled=false},isUnavailable:function(){return this.disabled},update:function(){var r=this,q=r.el.val();if(r.isInitialized()){r.currentValue=q;if(r.isQueryRequestable(q)){r.updateSuggestions(q)}else{r.hide()}}},setSuggestion:function(r){var s=this,q,t;if(a.isPlainObject(r)&&a.isPlainObject(r.data)){r=a.extend(true,{},r);if(s.bounds.own.length){s.checkValueBounds(r);q=s.copyBoundedData(r.data,s.bounds.all);if(r.data.kladr_id){q.kladr_id=s.getBoundedKladrId(r.data.kladr_id,s.bounds.all)}r.data=q}t=s.getSuggestionValue(r)||"";s.currentValue=t;s.el.val(t);s.selection=r;s.suggestions=[r];s.abortRequest();s.el.trigger("suggestions-set")}},fixData:function(){var t=this,r=t.extendedCurrentValue(),q=t.el.val(),s=a.Deferred();s.done(function(u){t.selectSuggestion(u,0,q,{hasBeenEnriched:true});t.el.trigger("suggestions-fixdata",u)}).fail(function(){t.selection=null;t.currentValue="";t.el.val(t.currentValue);t.el.trigger("suggestions-fixdata")});if(t.isQueryRequestable(r)){t.currentValue=r;t.getSuggestions(r,{count:1,from_bound:null,to_bound:null}).done(function(v){var u=v[0];if(u){s.resolve(u)}else{s.reject()}}).fail(function(){s.reject()})}else{s.reject()}},extendedCurrentValue:function(){var t=this,r=t.getParentInstance(),s=r&&r.extendedCurrentValue(),q=a.trim(t.el.val());return l.compact([s,q]).join(" ")},getAjaxParams:function(s,q){var x=this,y=a.trim(x.options.token),u=a.trim(x.options.partner),w=x.options.serviceUrl,v=i[s],t=a.extend({timeout:x.options.timeout},v.defaultParams),r={};if(!/\/$/.test(w)){w+="/"}w+=s;if(v.addTypeInUrl){w+="/"+x.type.urlSuffix}w=l.fixURLProtocol(w);if(a.support.cors){if(y){r.Authorization="Token "+y}if(u){r["X-Partner"]=u}r["X-Version"]=j.version;if(!t.headers){t.headers={}}a.extend(t.headers,x.options.headers,r)}else{if(y){r.token=y}if(u){r.partner=u}r.version=j.version;w=l.addUrlParams(w,r)}t.url=w;return a.extend(t,q)},isQueryRequestable:function(q){var s=this,r;r=q.length>=s.options.minChars;if(r&&s.type.isQueryRequestable){r=s.type.isQueryRequestable.call(s,q)}return r},constructRequestParams:function(t,q){var u=this,r=u.options,s=a.isFunction(r.params)?r.params.call(u.element,t):a.extend({},r.params);if(u.type.constructRequestParams){a.extend(s,u.type.constructRequestParams.call(u))}a.each(u.notify("requestParams"),function(w,v){a.extend(s,v)});s[r.paramName]=t;if(a.isNumeric(r.count)&&r.count>0){s.count=r.count}return a.extend(s,q)},updateSuggestions:function(q){var r=this;r.fetchPhase=r.getSuggestions(q).done(function(s){r.assignSuggestions(s,q)})},getSuggestions:function(v,r,w){var y,z=this,t=z.options,s=w&&w.noCallbacks,A=w&&w.useEnrichmentCache,u=z.constructRequestParams(v,r),q=a.param(u||{}),x=a.Deferred();y=z.cachedResponse[q];if(y&&a.isArray(y.suggestions)){x.resolve(y.suggestions)}else{if(z.isBadQuery(v)){x.reject()}else{if(!s&&t.onSearchStart.call(z.element,u)===false){x.reject()}else{z.doGetSuggestions(u).done(function(B){if(z.processResponse(B)&&v==z.currentValue){if(!t.noCache){if(A){z.enrichmentCache[v]=B.suggestions[0]}else{z.enrichResponse(B,v);z.cachedResponse[q]=B;if(t.preventBadQueries&&B.suggestions.length===0){z.badQueries.push(v)}}}x.resolve(B.suggestions)}else{x.reject()}if(!s){t.onSearchComplete.call(z.element,v,B.suggestions)}}).fail(function(C,D,B){x.reject();if(!s&&D!=="abort"){t.onSearchError.call(z.element,v,C,D,B)}})}}}return x},doGetSuggestions:function(q){var s=this,r=a.ajax(s.getAjaxParams(s.requestMode.method,{data:l.serialize(q)}));s.abortRequest();s.currentRequest=r;s.notify("request");r.always(function(){s.currentRequest=null;s.notify("request")});return r},isBadQuery:function(r){if(!this.options.preventBadQueries){return false}var s=false;a.each(this.badQueries,function(q,t){return !(s=r.indexOf(t)===0)});return s},abortRequest:function(){var q=this;if(q.currentRequest){q.currentRequest.abort()}},processResponse:function(q){var s=this,r;if(!q||!a.isArray(q.suggestions)){return false}s.verifySuggestionsFormat(q.suggestions);s.setUnrestrictedValues(q.suggestions);if(a.isFunction(s.options.onSuggestionsFetch)){r=s.options.onSuggestionsFetch.call(s.element,q.suggestions);if(a.isArray(r)){q.suggestions=r}}return true},verifySuggestionsFormat:function(q){if(typeof q[0]==="string"){a.each(q,function(r,s){q[r]={value:s,data:null}})}},getSuggestionValue:function(s){var t=this,q=t.options.formatSelected||t.type.formatSelected,r;if(a.isFunction(q)){r=q.call(t,s)}if(typeof r!=="string"||r.length==0){r=s.value}return r},assignSuggestions:function(r,q){var s=this;s.suggestions=r;s.notify("assignSuggestions",q)},shouldRestrictValues:function(){var q=this;return q.options.restrict_value&&q.constraints&&Object.keys(q.constraints).length==1},setUnrestrictedValues:function(s){var t=this,r=t.shouldRestrictValues(),q=t.getFirstConstraintLabel();a.each(s,function(u,v){if(!v.unrestricted_value){v.unrestricted_value=r?q+", "+v.value:v.value}})},areSuggestionsSame:function(q,r){return q&&r&&q.value===r.value&&l.areSame(q.data,r.data)}};(function(){var q={setupElement:function(){this.el.attr("autocomplete","off").addClass("suggestions-input").css("box-sizing","border-box")},bindElementEvents:function(){var r=this;r.el.on("keydown"+d,a.proxy(r.onElementKeyDown,r));r.el.on(["keyup"+d,"cut"+d,"paste"+d,"input"+d].join(" "),a.proxy(r.onElementKeyUp,r));r.el.on("blur"+d,a.proxy(r.onElementBlur,r));r.el.on("focus"+d,a.proxy(r.onElementFocus,r))},unbindElementEvents:function(){this.el.off(d)},onElementBlur:function(){var r=this;if(r.cancelBlur){r.cancelBlur=false;return}if(r.options.triggerSelectOnBlur){if(!r.isUnavailable()){r.selectCurrentValue({noSpace:true}).always(function(){r.hide()})}}else{r.hide()}if(r.fetchPhase.abort){r.fetchPhase.abort()}},onElementFocus:function(){var r=this;if(!r.cancelFocus){l.delay(a.proxy(r.completeOnFocus,r))}r.cancelFocus=false},onElementKeyDown:function(r){var s=this;if(s.isUnavailable()){return}if(!s.visible){switch(r.which){case e.DOWN:s.suggest();break;case e.ENTER:if(s.options.triggerSelectOnEnter){s.triggerOnSelectNothing()}break}return}switch(r.which){case e.ESC:s.el.val(s.currentValue);s.hide();s.abortRequest();break;case e.TAB:if(s.options.tabDisabled===false){return}break;case e.ENTER:if(s.options.triggerSelectOnEnter){s.selectCurrentValue()}break;case e.SPACE:if(s.options.triggerSelectOnSpace&&s.isCursorAtEnd()){r.preventDefault();s.selectCurrentValue({continueSelecting:true,dontEnrich:true}).fail(function(){s.currentValue+=" ";s.el.val(s.currentValue);s.proceedChangedValue()})}return;case e.UP:s.moveUp();break;case e.DOWN:s.moveDown();break;default:return}r.stopImmediatePropagation();r.preventDefault()},onElementKeyUp:function(r){var s=this;if(s.isUnavailable()){return}switch(r.which){case e.UP:case e.DOWN:case e.ENTER:return}clearTimeout(s.onChangeTimeout);s.inputPhase.reject();if(s.currentValue!==s.el.val()){s.proceedChangedValue()}},proceedChangedValue:function(){var r=this;r.abortRequest();r.inputPhase=a.Deferred().done(a.proxy(r.onValueChange,r));if(r.options.deferRequestBy>0){r.onChangeTimeout=l.delay(function(){r.inputPhase.resolve()},r.options.deferRequestBy)}else{r.inputPhase.resolve()}},onValueChange:function(){var s=this,r;if(s.selection){r=s.selection;s.selection=null;s.trigger("InvalidateSelection",r)}s.selectedIndex=-1;s.update();s.notify("valueChange")},completeOnFocus:function(){var r=this;if(r.isUnavailable()){return}if(r.isElementFocused()){r.fixPosition();r.update();if(r.isMobile){r.setCursorAtEnd();r.scrollToTop()}}},isElementFocused:function(){return document.activeElement===this.element},isCursorAtEnd:function(){var u=this,v=u.el.val().length,t,s;try{t=u.element.selectionStart;if(typeof t==="number"){return t===v}}catch(r){}if(document.selection){s=document.selection.createRange();s.moveStart("character",-v);return v===s.text.length}return true},setCursorAtEnd:function(){var r=this.element;try{r.selectionEnd=r.selectionStart=r.value.length;r.scrollLeft=r.scrollWidth}catch(s){r.value=r.value}}};a.extend(j.prototype,q);g.on("initialize",q.bindElementEvents).on("dispose",q.unbindElementEvents)}());(function(){var s={};function r(){a.each(s,function(){this.abort()});s={}}r();var q={checkStatus:function(){var v=this,w=a.trim(v.options.token),u=v.options.type+w,t=s[u];if(!t){t=s[u]=a.ajax(v.getAjaxParams("status"))}t.done(function(y){if(y.search){a.extend(v.status,y)}else{x("Service Unavailable")}}).fail(function(){x(t.statusText)});function x(y){if(a.isFunction(v.options.onSearchError)){v.options.onSearchError.call(v.element,null,t,"error",y)}}}};j.resetTokens=r;a.extend(j.prototype,q);g.on("setOptions",q.checkStatus)}());(function(){if(l.getDefaultType()=="GET"){return}var r,q=true;function t(){r=null;j.defaultOptions.geoLocation=q}var s={checkLocation:function(){var v=this,u=v.options.geoLocation;if(!v.type.geoEnabled||!u){return}v.geoLocation=a.Deferred();if(a.isPlainObject(u)||a.isArray(u)){v.geoLocation.resolve(u)}else{if(!r){r=a.ajax(v.getAjaxParams("detectAddressByIp"))}r.done(function(x){var w=x&&x.location&&x.location.data;if(w&&w.kladr_id){v.geoLocation.resolve(w)}else{v.geoLocation.reject()}}).fail(function(){v.geoLocation.reject()})}},getGeoLocation:function(){return this.geoLocation},constructParams:function(){var v=this,u={};if(v.geoLocation&&a.isFunction(v.geoLocation.promise)&&v.geoLocation.state()=="resolved"){v.geoLocation.done(function(w){u.locations_boost=a.makeArray(w)})}return u}};a.extend(c,{geoLocation:q});a.extend(j,{resetLocation:t});a.extend(j.prototype,{getGeoLocation:s.getGeoLocation});g.on("setOptions",s.checkLocation).on("requestParams",s.constructParams)}());(function(){var q={enrichSuggestion:function(t,s){var u=this,r=a.Deferred();if(!u.status.enrich||!u.type.enrichmentEnabled||!u.requestMode.enrichmentEnabled||s&&s.dontEnrich){return r.resolve(t)}if(t.data&&t.data.qc!=null){return r.resolve(t)}u.disableDropdown();u.currentValue=t.unrestricted_value;u.enrichPhase=u.getSuggestions(t.unrestricted_value,{count:1,locations:null,locations_boost:null,from_bound:null,to_bound:null},{noCallbacks:true,useEnrichmentCache:true}).always(function(){u.enableDropdown()}).done(function(w){var v=w&&w[0];r.resolve(v||t,!!v)}).fail(function(){r.resolve(t)});return r},enrichResponse:function(t,s){var u=this,r=u.enrichmentCache[s];if(r){a.each(t.suggestions,function(v,w){if(w.value===s){t.suggestions[v]=r;return false}})}}};a.extend(j.prototype,q)}());(function(){function r(v){return a.map(v,function(w){var x=l.escapeHtml(w.text);if(x&&w.matched){x="<strong>"+x+"</strong>"}return x}).join("")}function t(w,x){var v=w.split(", ");if(v.length===1){return w}return a.map(v,function(y){return'<span class="'+x+'">'+y+"</span>"}).join(", ")}function q(x,w){var v=false;a.each(x,function(y,z){v=z.value==w.value&&z!=w;if(v){return false}});return v}var u={width:"auto",floating:false};var s={createContainer:function(){var y=this,x="."+y.classes.suggestion,w=y.options,v=a("<div/>").addClass(w.containerClass).css({position:"absolute",display:"none"});y.$container=v;v.on("click"+d,x,a.proxy(y.onSuggestionClick,y))},removeContainer:function(){var v=this;if(v.options.floating){v.$container.remove()}},setContainerOptions:function(){var w=this,v="mousedown"+d;w.$container.off(v);if(w.options.floating){w.$container.on(v,a.proxy(w.onMousedown,w))}},onSuggestionClick:function(w){var y=this,v=a(w.target),x;if(!y.dropdownDisabled){y.cancelFocus=true;y.el.focus();while(v.length&&!(x=v.attr("data-index"))){v=v.closest("."+y.classes.suggestion)}if(x&&!isNaN(x)){y.select(+x)}}},setDropdownPosition:function(w,v){var z=this,x=z.$viewport.scrollLeft(),y;if(z.isMobile){y=z.options.floating?{left:x+"px",top:v.top+v.outerHeight+"px"}:{left:w.left-v.left+x+"px",top:w.top+v.outerHeight+"px"};y.width=z.$viewport.width()+"px"}else{y=z.options.floating?{left:v.left+"px",top:v.top+v.borderTop+v.innerHeight+"px"}:{left:w.left+"px",top:w.top+v.borderTop+v.innerHeight+"px"};l.delay(function(){var A=z.options.width;if(A==="auto"){A=z.el.outerWidth()}z.$container.outerWidth(A)})}z.$container.toggleClass(z.classes.mobile,z.isMobile).css(y);z.containerItemsPadding=v.left+v.borderLeft+v.paddingLeft-x},setItemsPositions:function(){var w=this,v=w.getSuggestionsItems();v.css("paddingLeft",w.isMobile?w.containerItemsPadding+"px":"")},getSuggestionsItems:function(){return this.$container.children("."+this.classes.suggestion)},toggleDropdownEnabling:function(v){this.dropdownDisabled=!v;this.$container.attr("disabled",!v)},disableDropdown:function(){this.toggleDropdownEnabling(false)},enableDropdown:function(){this.toggleDropdownEnabling(true)},hasSuggestionsToChoose:function(){var v=this;return v.suggestions.length>1||(v.suggestions.length===1&&(!v.selection||a.trim(v.suggestions[0].value)!==a.trim(v.selection.value)))},suggest:function(){var y=this,x=y.options,v,w;if(!y.requestMode.userSelect){return}if(!y.hasSuggestionsToChoose()){y.hide();return}v=x.formatResult||y.type.formatResult||y.formatResult;w=[];if(!y.isMobile&&x.hint&&y.suggestions.length){w.push('<div class="'+y.classes.hint+'">'+x.hint+"</div>")}y.selectedIndex=-1;a.each(y.suggestions,function(z,B){var A=y.makeSuggestionLabel(y.suggestions,B);if(B==y.selection){y.selectedIndex=z}w.push('<div class="'+y.classes.suggestion+'" data-index="'+z+'">');w.push(v.call(y,B.value,y.currentValue,B,{unformattableTokens:y.type.unformattableTokens}));if(A){w.push('<span class="'+y.classes.subtext_label+'">'+l.escapeHtml(A)+"</span>")}w.push("</div>")});y.$container.html(w.join(""));if(x.autoSelectFirst&&y.selectedIndex===-1){y.selectedIndex=0}if(y.selectedIndex!==-1){y.getSuggestionsItems().eq(y.selectedIndex).addClass(y.classes.selected)}if(a.isFunction(x.beforeRender)){x.beforeRender.call(y.element,y.$container)}y.$container.show();y.visible=true;y.fixPosition();y.setItemsPositions()},wrapFormattedValue:function(y,w){var x=this,v=l.getDeepValue(w.data,"state.status");return'<span class="'+x.classes.value+'"'+(v?' data-suggestion-status="'+v+'"':"")+">"+y+"</span>"},formatResult:function(z,v,x,w){var y=this;z=y.highlightMatches(z,v,x,w);return y.wrapFormattedValue(z,x)},highlightMatches:function(J,x,E,C){var F=this,w=[],I=C&&C.unformattableTokens,B=C&&C.maxLength,H,G,D=l.reWordExtractor(),A,K,z,v,y;if(!J){return""}H=l.formatToken(x).split(p);H=l.withSubTokens(H);G=a.map(H,function(L){return new RegExp("^((.*)(["+n+"]+))?("+l.escapeRegExChars(L)+")([^"+n+"]*["+n+"]*)","i")});while((A=D.exec(J))&&A[0]){K=A[1];w.push({text:K,inUpperCase:K.toLowerCase()!==K,formatted:l.formatToken(K),matchable:true});if(A[2]){w.push({text:A[2]})}}for(z=0;z<w.length;z++){v=w[z];if(v.matchable&&!v.matched&&(a.inArray(v.formatted,I)===-1||v.inUpperCase)){a.each(G,function(L,N){var P=N.exec(v.formatted),M,O=z+1;if(P){P={before:P[1]||"",beforeText:P[2]||"",beforeDelimiter:P[3]||"",text:P[4]||"",after:P[5]||""};if(P.before){w.splice(z,0,{text:v.text.substr(0,P.beforeText.length),formatted:P.beforeText,matchable:true},{text:P.beforeDelimiter});O+=2;M=P.before.length;v.text=v.text.substr(M);v.formatted=v.formatted.substr(M);z--}M=P.text.length+P.after.length;if(v.formatted.length>M){w.splice(O,0,{text:v.text.substr(M),formatted:v.formatted.substr(M),matchable:true});v.text=v.text.substr(0,M);v.formatted=v.formatted.substr(0,M)}if(P.after){M=P.text.length;w.splice(O,0,{text:v.text.substr(M),formatted:v.formatted.substr(M)});v.text=v.text.substr(0,M);v.formatted=v.formatted.substr(0,M)}v.matched=true;return false}})}}if(B){for(z=0;z<w.length&&B>=0;z++){v=w[z];B-=v.text.length;if(B<0){v.text=v.text.substr(0,v.text.length+B)+"..."}}w.length=z}y=r(w);return t(y,F.classes.nowrap)},makeSuggestionLabel:function(B,A){var C=this,v=C.type.fieldNames,y={},z=l.reWordExtractor(),x,D,w=[];if(v&&q(B,A)&&A.data){a.each(v,function(E){var F=A.data[E];if(F){y[E]=l.formatToken(F)}});if(!a.isEmptyObject(y)){while((x=z.exec(l.formatToken(A.value)))&&(D=x[1])){a.each(y,function(E,F){if(F==D){w.push(v[E]);delete y[E];return false}})}if(w.length){return w.join(", ")}}}},hide:function(){var v=this;v.visible=false;v.selectedIndex=-1;v.$container.hide().empty()},activate:function(x){var z=this,v,y=z.classes.selected,w;if(!z.dropdownDisabled){w=z.getSuggestionsItems();w.removeClass(y);z.selectedIndex=x;if(z.selectedIndex!==-1&&w.length>z.selectedIndex){v=w.eq(z.selectedIndex);v.addClass(y);return v}}return null},deactivate:function(v){var w=this;if(!w.dropdownDisabled){w.selectedIndex=-1;w.getSuggestionsItems().removeClass(w.classes.selected);if(v){w.el.val(w.currentValue)}}},moveUp:function(){var v=this;if(v.dropdownDisabled){return}if(v.selectedIndex===-1){if(v.suggestions.length){v.adjustScroll(v.suggestions.length-1)}return}if(v.selectedIndex===0){v.deactivate(true);return}v.adjustScroll(v.selectedIndex-1)},moveDown:function(){var v=this;if(v.dropdownDisabled){return}if(v.selectedIndex===(v.suggestions.length-1)){v.deactivate(true);return}v.adjustScroll(v.selectedIndex+1)},adjustScroll:function(x){var B=this,v=B.activate(x),z,y,A=B.$container.scrollTop(),w;if(!v||!v.length){return}z=v.position().top;if(z<0){B.$container.scrollTop(A+z)}else{y=z+v.outerHeight();w=B.$container.innerHeight();if(y>w){B.$container.scrollTop(A-w+y)}}B.el.val(B.suggestions[x].value)}};a.extend(c,u);a.extend(j.prototype,s);g.on("initialize",s.createContainer).on("dispose",s.removeContainer).on("setOptions",s.setContainerOptions).on("fixPosition",s.setDropdownPosition).on("fixPosition",s.setItemsPositions).on("assignSuggestions",s.suggest)}());(function(){var w="addon",t=50,s=1000;var v={addon:null};var r={NONE:"none",SPINNER:"spinner",CLEAR:"clear"};var q=function(y){var z=this,x=a('<span class="suggestions-addon"/>');z.owner=y;z.$el=x;z.type=r.NONE;z.visible=false;z.initialPadding=null;x.on("click",a.proxy(z,"onClick"))};q.prototype={checkType:function(){var y=this,z=y.owner.options.addon,x=false;a.each(r,function(A,B){x=B==z;if(x){return false}});if(!x){z=y.owner.isMobile?r.CLEAR:r.SPINNER}if(z!=y.type){y.type=z;y.$el.attr("data-addon-type",z);y.toggle(true)}},toggle:function(x){var y=this,z;switch(y.type){case r.CLEAR:z=!!y.owner.currentValue;break;case r.SPINNER:z=!!y.owner.currentRequest;break;default:z=false}if(z!=y.visible){y.visible=z;if(z){y.show(x)}else{y.hide(x)}}},show:function(x){var z=this,y={opacity:1};if(x){z.$el.show().css(y);z.showBackground(true)}else{z.$el.stop(true,true).delay(t).queue(function(){z.$el.show();z.showBackground();z.$el.dequeue()}).animate(y,"fast")}},hide:function(x){var z=this,y={opacity:0};if(x){z.$el.hide().css(y)}z.$el.stop(true).animate(y,{duration:"fast",complete:function(){z.$el.hide();z.hideBackground()}})},fixPosition:function(z,y){var A=this,x=y.innerHeight;A.checkType();A.$el.css({left:z.left+y.borderLeft+y.innerWidth-x+"px",top:z.top+y.borderTop+"px",height:x,width:x});A.initialPadding=y.paddingRight;A.width=x;if(A.visible){y.componentsRight+=x}},showBackground:function(y){var A=this,x=A.owner.el,z={paddingRight:A.width};if(A.width>A.initialPadding){A.stopBackground();if(y){x.css(z)}else{x.animate(z,{duration:"fast",queue:w}).dequeue(w)}}},hideBackground:function(y){var A=this,x=A.owner.el,z={paddingRight:A.initialPadding};if(A.width>A.initialPadding){A.stopBackground(true);if(y){x.css(z)}else{x.delay(s,w).animate(z,{duration:"fast",queue:w}).dequeue(w)}}},stopBackground:function(x){this.owner.el.stop(w,true,x)},onClick:function(x){var y=this;if(y.type==r.CLEAR){y.owner.clear()}}};var u={createAddon:function(){var y=this,x=new q(y);y.$wrapper.append(x.$el);y.addon=x},fixAddonPosition:function(y,x){this.addon.fixPosition(y,x)},checkAddonType:function(){this.addon.checkType()},checkAddonVisibility:function(){this.addon.toggle()},stopBackground:function(){this.addon.stopBackground()}};a.extend(c,v);g.on("initialize",u.createAddon).on("setOptions",u.checkAddonType).on("fixPosition",u.fixAddonPosition).on("clear",u.checkAddonVisibility).on("valueChange",u.checkAddonVisibility).on("request",u.checkAddonVisibility).on("resetPosition",u.stopBackground)}());(function(){var u={constraints:null,restrict_value:false};var s=["kladr_id","postal_code","country","region","area","city","settlement","street"];function r(v){var w={};if(a.isPlainObject(v)){a.each(v,function(x,y){if(y&&s.indexOf(x)>=0){w[x]=y}})}if(!a.isEmptyObject(w)){return w.kladr_id?{kladr_id:w.kladr_id}:w}}function q(y,v){var w=v.selection,x=w&&w.data&&v.bounds;if(x){a.each(v.bounds.all,function(A,z){return(x=w.data[z]===y.data[z])})}return x}var t={createConstraints:function(){var v=this;v.constraints={};v.$constraints=a('<ul class="suggestions-constraints"/>');v.$wrapper.append(v.$constraints);v.$constraints.on("click","."+v.classes.removeConstraint,a.proxy(v.onConstraintRemoveClick,v))},setConstraintsPosition:function(w,v){var x=this;x.$constraints.css({left:w.left+v.borderLeft+v.paddingLeft+"px",top:w.top+v.borderTop+Math.round((v.innerHeight-x.$constraints.height())/2)+"px"});v.componentsLeft+=x.$constraints.outerWidth(true)+v.paddingLeft},onConstraintRemoveClick:function(w){var y=this,v=a(w.target).closest("li"),x=v.attr("data-constraint-id");delete y.constraints[x];y.update();v.fadeOut("fast",function(){y.removeConstraint(x)})},setupConstraints:function(){var x=this,w=x.options.constraints,v;if(!w){x.unbindFromParent();return}if(w instanceof a||typeof w==="string"||typeof w.nodeType==="number"){v=a(w);if(!v.is(x.constraints)){x.unbindFromParent();if(!v.is(x.el)){x.constraints=v;x.bindToParent()}}}else{x._constraintsUpdating=true;a.each(x.constraints,a.proxy(x.removeConstraint,x));a.each(a.makeArray(w),function(z,y){x.addConstraint(y)});x._constraintsUpdating=false;x.fixPosition()}},formatConstraint:function(v){var x=this,w;if(v&&(v.locations||v.restrictions)){w=a.makeArray(v.locations||v.restrictions);if(v.label==null&&x.type.composeValue){v.label=a.map(w,function(y){return x.type.composeValue(y)}).join(", ")}v.locations=[];a.each(w,function(z,A){var y=r(A);if(y){v.locations.push(y)}});return v.locations.length?v:null}},addConstraint:function(w){var y=this,v,x;w=y.formatConstraint(w);if(!w){return}x=l.uniqueId("c");y.constraints[x]=w;if(w.label){v=a("<li/>").append(a("<span/>").text(w.label)).attr("data-constraint-id",x);if(w.deletable){v.append(a('<span class="suggestions-remove"/>'))}y.$constraints.append(v);if(!y._constraintsUpdating){y.fixPosition()}}},removeConstraint:function(v){var w=this;delete w.constraints[v];w.$constraints.children('[data-constraint-id="'+v+'"]').remove();if(!w._constraintsUpdating){w.fixPosition()}},constructConstraintsParams:function(){var A=this,w=[],v=A.constraints,z,y,x={};while(v instanceof a&&(z=v.suggestions())&&!(y=l.getDeepValue(z,"selection.data"))){v=z.constraints}if(v instanceof a){y=r(y);if(y){x.locations=[y];x.restrict_value=true}}else{if(v){a.each(v,function(C,B){w=w.concat(B.locations)});if(w.length){x.locations=w;x.restrict_value=A.options.restrict_value}}}return x},getFirstConstraintLabel:function(){var w=this,v=a.isPlainObject(w.constraints)&&Object.keys(w.constraints)[0];return v?w.constraints[v].label:""},bindToParent:function(){var v=this;v.constraints.on(["suggestions-select."+v.uniqueId,"suggestions-invalidateselection."+v.uniqueId,"suggestions-clear."+v.uniqueId].join(" "),a.proxy(v.onParentSelectionChanged,v)).on("suggestions-dispose."+v.uniqueId,a.proxy(v.onParentDispose,v))},unbindFromParent:function(){var w=this,v=w.constraints;if(v instanceof a){v.off("."+w.uniqueId)}},onParentSelectionChanged:function(v,w,x){if(v.type!=="suggestions-select"||x){this.clear()}},onParentDispose:function(v){this.unbindFromParent()},getParentInstance:function(){return this.constraints instanceof a&&this.constraints.suggestions()},shareWithParent:function(v){var w=this.getParentInstance();if(!w||w.type!==this.type||q(v,w)){return}w.shareWithParent(v);w.setSuggestion(v)}};a.extend(c,u);a.extend(j.prototype,t);if(l.getDefaultType()=="GET"){return}g.on("initialize",t.createConstraints).on("setOptions",t.setupConstraints).on("fixPosition",t.setConstraintsPosition).on("requestParams",t.constructConstraintsParams).on("dispose",t.unbindFromParent)}());(function(){var q={proceedQuery:function(r){var s=this;if(r.length>=s.options.minChars){s.updateSuggestions(r)}else{s.hide()}},selectCurrentValue:function(s){var t=this,r=a.Deferred();t.inputPhase.resolve();t.fetchPhase.done(function(){var u;if(t.selection&&!t.visible){r.reject()}else{u=t.findSuggestionIndex();t.select(u,s);if(u===-1){r.reject()}else{r.resolve(u)}}}).fail(function(){r.reject()});return r},selectFoundSuggestion:function(){var r=this;if(!r.requestMode.userSelect){r.select(0)}},findSuggestionIndex:function(){var s=this,r=s.selectedIndex,t;if(r===-1){t=a.trim(s.el.val());if(t){a.each(s.type.matchers,function(u,v){r=v(t,s.suggestions);return r===-1})}}return r},select:function(t,u){var w=this,v=w.suggestions[t],r=u&&u.continueSelecting,s=w.currentValue;if(w.triggering.Select){return}if(!v){if(!r&&!w.selection){w.triggerOnSelectNothing()}w.onSelectComplete(r);return}w.enrichSuggestion(v,u).done(function(x,y){w.selectSuggestion(x,t,s,a.extend({hasBeenEnriched:y},u))})},selectSuggestion:function(x,u,v,w){var y=this,s=w.continueSelecting,r=!y.type.isDataComplete||y.type.isDataComplete.call(y,x),t=y.selection;if(y.triggering.Select){return}if(y.type.alwaysContinueSelecting){s=true}if(r){s=false}if(w.hasBeenEnriched&&y.suggestions[u]){y.suggestions[u].data=x.data}if(y.requestMode.updateValue){y.checkValueBounds(x);y.currentValue=y.getSuggestionValue(x);if(y.currentValue&&!w.noSpace&&!r){y.currentValue+=" "}y.el.val(y.currentValue)}if(y.currentValue){y.selection=x;if(!y.areSuggestionsSame(x,t)){y.trigger("Select",x,y.currentValue!=v)}if(y.requestMode.userSelect){y.onSelectComplete(s)}}else{y.selection=null;y.triggerOnSelectNothing()}y.shareWithParent(x)},onSelectComplete:function(r){var s=this;if(r){s.selectedIndex=-1;s.updateSuggestions(s.currentValue)}else{s.hide()}},triggerOnSelectNothing:function(){var r=this;if(!r.triggering.SelectNothing){r.trigger("SelectNothing",r.currentValue)}},trigger:function(t){var u=this,r=l.slice(arguments,1),s=u.options["on"+t];u.triggering[t]=true;if(a.isFunction(s)){s.apply(u.element,r)}u.el.trigger.call(u.el,"suggestions-"+t.toLowerCase(),r);u.triggering[t]=false}};a.extend(j.prototype,q);g.on("assignSuggestions",q.selectFoundSuggestion)}());(function(){var s={bounds:null};var q={region:{digits:2,zeros:11},area:{digits:5,zeros:8},city:{digits:8,zeros:5},settlement:{digits:11,zeros:2},street:{digits:15,zeros:2},house:{digits:19}};var r={setupBounds:function(){this.bounds={from:null,to:null}},setBoundsOptions:function(){var B=this,w=B.type.boundsAvailable,A=a.trim(B.options.bounds).split("-"),t=A[0],y=A[A.length-1],x=[],u,v=[],z;if(a.inArray(t,w)===-1){t=null}z=a.inArray(y,w);if(z===-1||z===w.length-1){y=null}if(t||y){u=!t;a.each(w,function(D,C){if(C==t){u=true}v.push(C);if(u){x.push(C)}if(C==y){return false}})}B.bounds.from=t;B.bounds.to=y;B.bounds.all=v;B.bounds.own=x},constructBoundsParams:function(){var u=this,t={};if(u.bounds.from){t.from_bound={value:u.bounds.from}}if(u.bounds.to){t.to_bound={value:u.bounds.to}}return t},checkValueBounds:function(t){var u=this,v;if(u.bounds.own.length&&u.type.composeValue){v=u.copyBoundedData(t.data,u.bounds.own);t.value=u.type.composeValue(v)}},copyBoundedData:function(v,u){var w={},t=this.type.boundsFields;if(t){a.each(u,function(z,x){var y=t[x];if(y){a.each(y,function(B,A){if(v[A]!=null){w[A]=v[A]}})}})}return w},getBoundedKladrId:function(v,t){var u=t[t.length-1],w=q[u],x=v.substr(0,w.digits);if(w.zeros){x+=new Array(w.zeros+1).join("0")}return x}};a.extend(c,s);a.extend(a.Suggestions.prototype,r);g.on("initialize",r.setupBounds).on("setOptions",r.setBoundsOptions).on("requestParams",r.constructBoundsParams)})();a.fn.suggestions=function(r,q){if(arguments.length===0){return this.first().data(b)}return this.each(function(){var s=a(this),t=s.data(b);if(typeof r==="string"){if(t&&typeof t[r]==="function"){t[r](q)}}else{if(t&&t.dispose){t.dispose()}t=new j(this,r);s.data(b,t)}})}}));
